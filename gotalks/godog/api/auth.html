<div class="code">
<pre><code class="go">func (a *API) auth(w http.ResponseWriter, req *http.Request) {
  if _, hasHeader := req.Header["Authorization"]; !hasHeader {
    http.Error(w, "authentication required", 401)
    return
  }
  auth := strings.SplitN(req.Header["Authorization"][0], " ", 2)
  if len(auth) != 2 || auth[0] != "Basic" {
    http.Error(w, "bad syntax", http.StatusBadRequest)
    return
  }

  payload, _ := base64.StdEncoding.DecodeString(auth[1])
  pair := strings.SplitN(string(payload), ":", 2)
  if len(pair) != 2 || pair[0] != "user" || pair[1] != "pass" {
    http.Error(w, "authorization failed", http.StatusUnauthorized)
    return
  }
  a.users(w, req)
}</code></pre>

</div>
